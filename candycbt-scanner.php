<?php 
error_reporting(0);
$banner = "
  ---------------------------------
      CandyCBT Exploit Scanner
  --------------------------------- 
\n";

if(!$argv[1]){
    print $banner;
    print " use: php {$argv[0]} https://site.com/\n";
        exit(1);
    }else{
        $site = $argv[1];
        print $banner;
    }
    $path = array('Exploit v2.0 - v2.4 [1]' => 'plugins/uploadfile/demo/upload.php',
                    'Exploit v2.0 - v2.4 [2]' => 'plugins/uploadfile/php/upload.php',
                    'Exploit v2.0 - v2.4 [3]' => 'plugins/uploadfile/demo/demo.html',
                    'Exploit v2.0 - v2.7' => 'admin/ifm.php',
                    'Exploit v2.5 - v2.7 [1]' => 'admin/simpan_setting.php',
                    'Exploit v2.5 - v2.7 [2]' => 'admin/filesoal.php',
                    'Exlpoit v2.6 - v2.7 [1]' => 'admin/soal/import_file.php',
                    'Exlpoit v2.6 - v2.7 [2]' => 'admin/upload_foto.php',
                    'Exploit v2.8' => 'admin/restore.php'
                    );
    $total=0;
    foreach ($path as $key => $page) {
        $url = $site.$page;
        file_get_contents($url);
        if(preg_match('/200/i', $http_response_header[0])){
            $total++;
            echo "[+] {$key} Found -> {$url}\n";
            $file = fopen("result.txt", "w+");
                  fwrite($file, $url . "\r\n");
                  fclose($file);
        }else{
            echo "[-] {$key} Not Found -> {$url}\n";
        }
    }
    echo "\nTotal found exploit: {$total} | Saved to result.txt\n";
?>
